{"version":3,"file":"cs-client.js","sourceRoot":"","sources":["../../../client-src/js-src/cs-client.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * Copyright 2021 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @typedef {object} FeatureLink\n * @property {string} url\n * @property {string} type\n * @property {object} information - fields depend on type; see link_helpers.py\n * @property {number} http_error_code\n */\n\n// prettier-ignore\n(function(exports) {\n'use strict';\n\n/**\n * Generic Chrome Status Http Error.\n */\nclass ChromeStatusHttpError extends Error {\n  constructor(message, resource, method, status) {\n    super(message);\n    this.name = 'ChromeStatusHttpError';\n    this.resource = resource;\n    this.method = method;\n    this.status = status;\n  }\n}\n\n/**\n * FeatureNotFoundError represents an error for when a feature was not found\n * for the given ID.\n */\nclass FeatureNotFoundError extends Error {\n  constructor(featureID) {\n    super('Feature not found');\n    this.name = 'FeatureNotFoundError';\n    this.featureID = featureID;\n  }\n}\n\nclass ChromeStatusClient {\n  constructor(token, tokenExpiresSec) {\n    this.token = token;\n    this.tokenExpiresSec = tokenExpiresSec;\n    this.baseUrl = '/api/v0'; // Same scheme, host, and port.\n  }\n\n  /* Refresh the XSRF token if necessary. */\n  async ensureTokenIsValid() {\n    if (ChromeStatusClient.isTokenExpired(this.tokenExpiresSec)) {\n      const refreshResponse = await this.doFetch(\n        '/currentuser/token', 'POST', null);\n      this.token = refreshResponse.token;\n      this.tokenExpiresSec = refreshResponse.token_expires_sec;\n    }\n  }\n\n  /* Return true if the XSRF token has expired. */\n  static isTokenExpired(tokenExpiresSec) {\n    const tokenExpiresDate = new Date(tokenExpiresSec * 1000);\n    return tokenExpiresDate < new Date();\n  }\n\n  /* Make a JSON API call to the server, including an XSRF header.\n   * Then strip off the defensive prefix from the response. */\n  async doFetch(resource, httpMethod, body, includeToken=true) {\n    const url = this.baseUrl + resource;\n    const headers = {\n      'accept': 'application/json',\n      'content-type': 'application/json',\n    };\n    if (includeToken) {\n      headers['X-Xsrf-Token'] = this.token;\n    }\n    const options = {\n      method: httpMethod,\n      credentials: 'same-origin',\n      headers: headers,\n    };\n    if (body !== null) {\n      options['body'] = JSON.stringify(body);\n    }\n\n    const response = await fetch(url, options);\n\n    if (response.status !== 200) {\n      throw new ChromeStatusHttpError(\n        `Got error response from server ${resource}: ${response.status}`,\n        resource,\n        httpMethod,\n        response.status);\n    }\n    const rawResponseText = await response.text();\n    const XSSIPrefix = ')]}\\'\\n';\n    if (!rawResponseText.startsWith(XSSIPrefix)) {\n      throw new Error(\n          `Response does not start with XSSI prefix: ${XSSIPrefix}`);\n    }\n    return JSON.parse(rawResponseText.substr(XSSIPrefix.length));\n  }\n\n  async doGet(resource, body) {\n    // GET's do not use token.\n    return this.doFetch(resource, 'GET', body, false);\n  }\n\n  async doPost(resource, body) {\n    return this.ensureTokenIsValid().then(() => {\n      return this.doFetch(resource, 'POST', body);\n    });\n  }\n\n  async doPatch(resource, body) {\n    return this.ensureTokenIsValid().then(() => {\n      return this.doFetch(resource, 'PATCH', body);\n    });\n  }\n\n  async doDelete(resource) {\n    return this.ensureTokenIsValid().then(() => {\n      return this.doFetch(resource, 'DELETE', null);\n    });\n  }\n\n\n  // //////////////////////////////////////////////////////////////\n  // Specific API calls\n\n  // Signing in and out\n\n  signIn(credentialResponse) {\n    const credential = credentialResponse.credential;\n    // We don't use doPost because we don't already have a XSRF token.\n    return this.doFetch('/login', 'POST', {'credential': credential}, false);\n  }\n\n  signOut() {\n    return this.doPost('/logout');\n  }\n\n  // Cues API\n\n  getDismissedCues() {\n    return this.doGet('/currentuser/cues');\n  }\n\n  dismissCue(cue) {\n    return this.doPost('/currentuser/cues', {cue: cue})\n      .then((res) => res);\n    // TODO: catch((error) => { display message }\n  }\n\n  // Permissions API\n  getPermissions(returnPairedUser=false) {\n    let url = '/currentuser/permissions';\n    if (returnPairedUser) {\n      url += '?returnPairedUser';\n    }\n    return this.doGet(url)\n      .then((res) => res.user);\n  }\n\n  // Settings API\n\n  getSettings() {\n    return this.doGet('/currentuser/settings');\n  }\n\n  setSettings(notify) {\n    return this.doPost('/currentuser/settings', {notify: notify});\n  }\n\n  // Star API\n\n  getStars() {\n    return this.doGet('/currentuser/stars')\n      .then((res) => res.featureIds);\n    // TODO: catch((error) => { display message }\n  }\n\n  setStar(featureId, starred) {\n    return this.doPost(\n      '/currentuser/stars',\n      {featureId: featureId, starred: starred})\n      .then((res) => res);\n    // TODO: catch((error) => { display message }\n  }\n\n  // Accounts API\n\n  createAccount(email, isAdmin, isSiteEditor) {\n    return this.doPost('/accounts', {email, isAdmin, isSiteEditor});\n    // TODO: catch((error) => { display message }\n  }\n\n  deleteAccount(accountId) {\n    return this.doDelete('/accounts/' + accountId);\n    // TODO: catch((error) => { display message }\n  }\n\n  getVotes(featureId, gateId) {\n    if (gateId) {\n      return this.doGet(`/features/${featureId}/votes/${gateId}`);\n    }\n    return this.doGet(`/features/${featureId}/votes`);\n  }\n\n  setVote(featureId, gateId, state) {\n    return this.doPost(\n        `/features/${featureId}/votes/${gateId}`,\n        {state: Number(state)});\n  }\n\n  getGates(featureId) {\n    return this.doGet(`/features/${featureId}/gates`);\n  }\n\n  getPendingGates() {\n    return this.doGet('/gates/pending');\n  }\n\n  updateGate(featureId, gateId, assignees) {\n    return this.doPost(\n        `/features/${featureId}/gates/${gateId}`,\n        {assignees,\n        });\n  }\n\n  getComments(featureId, gateId) {\n    let url = `/features/${featureId}/approvals/comments`;\n    if (gateId) {\n      url = `/features/${featureId}/approvals/${gateId}/comments`;\n    }\n    return this.doGet(url);\n  }\n\n  postComment(featureId, gateId, comment, postToThreadType) {\n    if (gateId) {\n      return this.doPost(\n          `/features/${featureId}/approvals/${gateId}/comments`,\n          {comment, postToThreadType});\n    } else {\n      return this.doPost(\n          `/features/${featureId}/approvals/comments`,\n          {comment, postToThreadType});\n    }\n  }\n\n  deleteComment(featureId, commentId) {\n    return this.doPatch(\n      `/features/${featureId}/approvals/comments`,\n      {commentId, isUndelete: false},\n    );\n  }\n\n  undeleteComment(featureId, commentId) {\n    return this.doPatch(\n      `/features/${featureId}/approvals/comments`,\n      {commentId, isUndelete: true},\n    );\n  }\n\n  // Features API\n  async getFeature(featureId) {\n    return this.doGet(`/features/${featureId}`)\n      .catch((error) => {\n        // If not the ChromeStatusHttpError, continue throwing.\n        if (!(error instanceof ChromeStatusHttpError)) {\n          throw error;\n        }\n        // Else, do further validations\n        if (error.status === 404) {\n          throw new FeatureNotFoundError(featureId);\n        }\n        // No other special cases means, we can re throw the error.\n        throw error;\n      });\n  }\n\n  async getFeaturesInMilestone(milestone) {\n    return this.doGet(`/features?milestone=${milestone}`).then(\n      (resp) => resp['features_by_type']);\n  }\n\n  async getFeaturesForEnterpriseReleaseNotes(milestone) {\n    return this.doGet(`/features?releaseNotesMilestone=${milestone}`);\n  }\n\n  async searchFeatures(userQuery, showEnterprise, sortSpec, start, num) {\n    let url = `/features?q=${userQuery}`;\n    if (showEnterprise) {\n      url += '&showEnterprise';\n    }\n    if (sortSpec) {\n      url += '&sort=' + sortSpec;\n    }\n    if (start) {\n      url += '&start=' + start;\n    }\n    if (num) {\n      url += '&num=' + num;\n    }\n    return this.doGet(url);\n  }\n\n  async updateFeature(featureChanges) {\n    return this.doPatch('/features', featureChanges);\n  }\n\n  // FeatureLinks API\n\n  /**\n   * @param {number} featureId\n   * @returns {Promise<{data: FeatureLink[], has_stale_links: boolean}>}\n   */\n  async getFeatureLinks(featureId, updateStaleLinks=true) {\n    return this.doGet(`/feature_links?feature_id=${featureId}&update_stale_links=${updateStaleLinks}`);\n  }\n\n  async getFeatureLinksSummary() {\n    return this.doGet('/feature_links_summary');\n  }\n\n  async getFeatureLinksSamples(domain, type, isError) {\n    let optionalParams = '';\n    if (type) {\n      optionalParams += `&type=${type}`;\n    }\n    if (isError !== undefined && isError !== null) {\n      optionalParams += `&is_error=${isError}`;\n    }\n    return this.doGet(`/feature_links_samples?domain=${domain}${optionalParams}`);\n  }\n\n  // Stages API\n  async getStage(featureId, stageId) {\n    return this.doGet(`/features/${featureId}/stages/${stageId}`);\n  }\n\n  async deleteStage(featureId, stageId) {\n    return this.doDelete(`/features/${featureId}/stages/${stageId}`);\n  }\n\n  async createStage(featureId, body) {\n    return this.doPost(`/features/${featureId}/stages`, body);\n  }\n\n  async updateStage(featureId, stageId, body) {\n    return this.doPatch(`/features/${featureId}/stages/${stageId}`, body);\n  }\n\n  async addXfnGates(featureId, stageId) {\n    return this.doPost(\n        `/features/${featureId}/stages/${stageId}/addXfnGates`);\n  }\n\n  // Origin trials API\n  async getOriginTrials() {\n    return this.doGet('/origintrials');\n  }\n\n  async createOriginTrial(featureId, stageId, body) {\n    return this.doPost(`/origintrials/${featureId}/${stageId}/create`, body);\n  }\n\n  async extendOriginTrial(featureId, stageId, body) {\n    return this.doPatch(`/origintrials/${featureId}/${stageId}/extend`, body);\n  }\n\n  // Processes API\n  async getFeatureProcess(featureId) {\n    return this.doGet(`/features/${featureId}/process`);\n  }\n\n  // Progress API\n  async getFeatureProgress(featureId) {\n    return this.doGet(`/features/${featureId}/progress`);\n  }\n\n  // Blinkcomponents API\n  async getBlinkComponents() {\n    return this.doGet('/blinkcomponents');\n  }\n\n  // Channels API\n  async getChannels() {\n    return this.doGet('/channels');\n  }\n\n  async getSpecifiedChannels(start, end) {\n    return this.doGet(`/channels?start=${start}&end=${end}`);\n  }\n};\n\nexports.ChromeStatusClient = ChromeStatusClient;\nexports.FeatureNotFoundError = FeatureNotFoundError;\n})(window);\n"]}